"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[98],{5098:function(t,e,n){n.r(e),n.d(e,{encodeIntoResult:function(){return p},stegaEncodeSourceMap:function(){return g},stegaEncodeSourceMap$1:function(){return y}});var r=n(1069);let o=/_key\s*==\s*['"](.*)['"]/;function i(t){if(!Array.isArray(t))throw Error("Path is not an array");return t.reduce((t,e,n)=>{let r=typeof e;if("number"===r)return"".concat(t,"[").concat(e,"]");if("string"===r)return"".concat(t).concat(0===n?"":".").concat(e);if(("string"==typeof e?o.test(e.trim()):"object"==typeof e&&"_key"in e)&&e._key)return"".concat(t,'[_key=="').concat(e._key,'"]');if(Array.isArray(e)){let[n,r]=e;return"".concat(t,"[").concat(n,":").concat(r,"]")}throw Error("Unsupported path segment `".concat(JSON.stringify(e),"`"))},"")}let a={"\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","'":"\\'","\\":"\\\\"},l={"\\f":"\f","\\n":"\n","\\r":"\r","\\t":"	","\\'":"'","\\\\":"\\"};function c(t){let e;let n=[],r=/\['(.*?)'\]|\[(\d+)\]|\[\?\(@\._key=='(.*?)'\)\]/g;for(;null!==(e=r.exec(t));){if(void 0!==e[1]){let t=e[1].replace(/\\(\\|f|n|r|t|')/g,t=>l[t]);n.push(t);continue}if(void 0!==e[2]){n.push(parseInt(e[2],10));continue}if(void 0!==e[3]){let t=e[3].replace(/\\(\\')/g,t=>l[t]);n.push({_key:t,_index:-1});continue}}return n}function u(t){return t.map(t=>{if("string"==typeof t||"number"==typeof t)return t;if(""!==t._key)return{_key:t._key};if(-1!==t._index)return t._index;throw Error("invalid segment:".concat(JSON.stringify(t)))})}function s(t){return"object"==typeof t&&null!==t}function p(t,e,n){return function t(e,n,r=[]){return null!==e&&Array.isArray(e)?e.map((e,o)=>{if(s(e)){let i=e._key;if("string"==typeof i)return t(e,n,r.concat({_key:i,_index:o}))}return t(e,n,r.concat(o))}):s(e)?Object.fromEntries(Object.entries(e).map(([e,o])=>[e,t(o,n,r.concat(e))])):n(e,r)}(t,(t,r)=>{if("string"!=typeof t)return t;let o=function(t,e){var n;if(!(null==e?void 0:e.mappings))return;let r=(n=t.map(t=>{if("string"==typeof t||"number"==typeof t)return t;if(-1!==t._index)return t._index;throw Error("invalid segment:".concat(JSON.stringify(t)))}),"$".concat(n.map(t=>{if("string"==typeof t){let e=t.replace(/[\f\n\r\t'\\]/g,t=>a[t]);return"['".concat(e,"']")}if("number"==typeof t)return"[".concat(t,"]");if(""!==t._key){let e=t._key.replace(/['\\]/g,t=>a[t]);return"[?(@._key=='".concat(e,"')]")}return"[".concat(t._index,"]")}).join("")));if(void 0!==e.mappings[r])return{mapping:e.mappings[r],matchedPath:r,pathSuffix:""};let o=Object.entries(e.mappings).filter(([t])=>r.startsWith(t)).sort(([t],[e])=>e.length-t.length);if(0==o.length)return;let[i,l]=o[0],c=r.substring(i.length);return{mapping:l,matchedPath:i,pathSuffix:c}}(r,e);if(!o)return t;let{mapping:i,matchedPath:l}=o;if("value"!==i.type||"documentValue"!==i.source.type)return t;let u=e.documents[i.source.document],s=e.paths[i.source.path],p=c(l);return n({sourcePath:c(s).concat(r.slice(p.length)),sourceDocument:u,resultPath:r,value:t})})}let f="drafts.",d=({sourcePath:t,value:e})=>{if(/^\d{4}-\d{2}-\d{2}/.test(e)&&Date.parse(e)||function(t){try{new URL(t,t.startsWith("/")?"https://acme.com":void 0)}catch{return!1}return!0}(e))return!1;let n=t.at(-1);return!("slug"===t.at(-2)&&"current"===n||"string"==typeof n&&n.startsWith("_")||"number"==typeof n&&"marks"===t.at(-2)||"href"===n&&"number"==typeof t.at(-2)&&"markDefs"===t.at(-3)||"style"===n||"listItem"===n||t.some(t=>"meta"===t||"metadata"===t||"openGraph"===t||"seo"===t)||"string"==typeof n&&h.has(n))},h=new Set(["color","colour","currency","email","format","gid","hex","href","hsl","hsla","icon","id","index","key","language","layout","link","linkAction","locale","lqip","page","path","ref","rgb","rgba","route","secret","slug","status","tag","template","theme","type","unit","url","username","variant","website"]);function g(t,e,n){var a,l,c,s,h,g,y,m,k;let{filter:_,logger:b,enabled:v}=n;if(!v){let r="config.enabled must be true, don't call this function otherwise";throw null==(a=null==b?void 0:b.error)||a.call(b,"[@sanity/client/stega]: ".concat(r),{result:t,resultSourceMap:e,config:n}),TypeError(r)}if(!e)return null==(l=null==b?void 0:b.error)||l.call(b,"[@sanity/client/stega]: Missing Content Source Map from response body",{result:t,resultSourceMap:e,config:n}),t;if(!n.studioUrl){let r="config.studioUrl must be defined";throw null==(c=null==b?void 0:b.error)||c.call(b,"[@sanity/client/stega]: ".concat(r),{result:t,resultSourceMap:e,config:n}),TypeError(r)}let w={encoded:[],skipped:[]},E=p(t,e,({sourcePath:t,sourceDocument:e,resultPath:o,value:a})=>{var l;let c;if(("function"==typeof _?_({sourcePath:t,resultPath:o,filterDefault:d,sourceDocument:e,value:a}):d({sourcePath:t,resultPath:o,filterDefault:d,sourceDocument:e,value:a}))===!1)return b&&w.skipped.push({path:i(u(t)),value:"".concat(a.slice(0,20)).concat(a.length>20?"...":""),length:a.length}),a;b&&w.encoded.push({path:i(u(t)),value:"".concat(a.slice(0,20)).concat(a.length>20?"...":""),length:a.length});let{baseUrl:s,workspace:p,tool:h}=("/"!==(c="string"==typeof(l="function"==typeof n.studioUrl?n.studioUrl(e):n.studioUrl)?l:l.baseUrl)&&(c=c.replace(/\/$/,"")),"string"==typeof l)?{baseUrl:c}:{...l,baseUrl:c};if(!s)return a;let{_id:g,_type:y}=e;return(0,r.b)(a,{origin:"sanity.io",href:function(t){let{baseUrl:e,workspace:n="default",tool:r="default",id:o,type:a,path:l}=t;if(!e)throw Error("baseUrl is required");if(!l)throw Error("path is required");if(!o)throw Error("id is required");if("/"!==e&&e.endsWith("/"))throw Error("baseUrl must not end with a slash");let c="default"===n?void 0:n,s="default"===r?void 0:r,p=o.startsWith(f)?o.slice(f.length):o,d=Array.isArray(l)?i(u(l)):l,h=new URLSearchParams({baseUrl:e,id:p,type:a,path:d});c&&h.set("workspace",c),s&&h.set("tool",s);let g=["/"===e?"":e];c&&g.push(c);let y=["mode=presentation","id=".concat(p),"type=".concat(a),"path=".concat(encodeURIComponent(d))];return s&&y.push("tool=".concat(s)),g.push("intent","edit","".concat(y.join(";"),"?").concat(h)),g.join("/")}({baseUrl:s,workspace:p,tool:h,id:g,type:y,path:t})},!1)});if(b){let t=w.skipped.length,e=w.encoded.length;if((t||e)&&(null==(s=(null==b?void 0:b.groupCollapsed)||b.log)||s("[@sanity/client/stega]: Encoding source map into result"),null==(h=b.log)||h.call(b,"[@sanity/client/stega]: Paths encoded: ".concat(w.encoded.length,", skipped: ").concat(w.skipped.length))),w.encoded.length>0&&(null==(g=null==b?void 0:b.log)||g.call(b,"[@sanity/client/stega]: Table of encoded paths"),null==(y=(null==b?void 0:b.table)||b.log)||y(w.encoded)),w.skipped.length>0){let t=new Set;for(let{path:e}of w.skipped)t.add(e.replace(o,"0").replace(/\[\d+\]/g,"[]"));null==(m=null==b?void 0:b.log)||m.call(b,"[@sanity/client/stega]: List of skipped paths",[...t.values()])}(t||e)&&(null==(k=null==b?void 0:b.groupEnd)||k.call(b))}return E}var y=Object.freeze({__proto__:null,stegaEncodeSourceMap:g})}}]);